"use strict";(globalThis.webpackChunkphysical_ai_book=globalThis.webpackChunkphysical_ai_book||[]).push([[627],{6228(e,n,s){s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"module-1-ros-fundamentals/nodes-topics-services","title":"Nodes, Topics, and Services","description":"In ROS 2, the fundamental concepts of Nodes, Topics, and Services form the backbone of robot communication. Understanding these concepts is crucial for developing any robotic system.","source":"@site/docs/module-1-ros-fundamentals/nodes-topics-services.md","sourceDirName":"module-1-ros-fundamentals","slug":"/module-1-ros-fundamentals/nodes-topics-services","permalink":"/physical-ai-humanoid-robotics-book/docs/module-1-ros-fundamentals/nodes-topics-services","draft":false,"unlisted":false,"editUrl":"https://github.com/your-organization/physical-ai-humanoid-robotics-book/edit/main/book/docs/module-1-ros-fundamentals/nodes-topics-services.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Introduction to ROS 2","permalink":"/physical-ai-humanoid-robotics-book/docs/module-1-ros-fundamentals/introduction-to-ros2"},"next":{"title":"rclpy Basics","permalink":"/physical-ai-humanoid-robotics-book/docs/module-1-ros-fundamentals/rclpy-basics"}}');var r=s(4848),t=s(8453);const l={sidebar_position:2},o="Nodes, Topics, and Services",a={},c=[{value:"Nodes",id:"nodes",level:2},{value:"Creating a Node",id:"creating-a-node",level:3},{value:"Topics and Publishers/Subscribers",id:"topics-and-publisherssubscribers",level:2},{value:"Publishers",id:"publishers",level:3},{value:"Subscribers",id:"subscribers",level:3},{value:"Services",id:"services",level:2},{value:"Creating a Service Server",id:"creating-a-service-server",level:3},{value:"Creating a Service Client",id:"creating-a-service-client",level:3},{value:"Communication Patterns Comparison",id:"communication-patterns-comparison",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Example: Simple Publisher-Subscriber System",id:"example-simple-publisher-subscriber-system",level:2},{value:"Example: Service/Client Implementation",id:"example-serviceclient-implementation",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"nodes-topics-and-services",children:"Nodes, Topics, and Services"})}),"\n",(0,r.jsx)(n.p,{children:"In ROS 2, the fundamental concepts of Nodes, Topics, and Services form the backbone of robot communication. Understanding these concepts is crucial for developing any robotic system."}),"\n",(0,r.jsx)(n.h2,{id:"nodes",children:"Nodes"}),"\n",(0,r.jsx)(n.p,{children:"A node is a process that performs computation. In ROS 2, nodes are designed to be modular, allowing you to break down complex robot behaviors into smaller, manageable pieces. Each node typically performs a specific task and communicates with other nodes through topics, services, or actions."}),"\n",(0,r.jsx)(n.h3,{id:"creating-a-node",children:"Creating a Node"}),"\n",(0,r.jsxs)(n.p,{children:["In Python, using the ",(0,r.jsx)(n.code,{children:"rclpy"})," library, you create a node by subclassing ",(0,r.jsx)(n.code,{children:"rclpy.node.Node"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\n\nclass MinimalPublisher(Node):\n    def __init__(self):\n        super().__init__('minimal_publisher')\n        self.publisher = self.create_publisher(String, 'topic', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = 'Hello World: %d' % self.i\n        self.publisher.publish(msg)\n        self.get_logger().info('Publishing: \"%s\"' % msg.data)\n        self.i += 1\n"})}),"\n",(0,r.jsx)(n.h2,{id:"topics-and-publisherssubscribers",children:"Topics and Publishers/Subscribers"}),"\n",(0,r.jsx)(n.p,{children:"Topics enable a publish-subscribe communication model in ROS 2. This is an asynchronous communication method where publishers send messages to a topic without knowing who (if anyone) is subscribed to that topic."}),"\n",(0,r.jsx)(n.h3,{id:"publishers",children:"Publishers"}),"\n",(0,r.jsx)(n.p,{children:"A publisher sends messages to a specific topic. Multiple publishers can publish to the same topic, and multiple subscribers can subscribe to the same topic."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Create a publisher\nself.publisher = self.create_publisher(String, 'topic', 10)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"subscribers",children:"Subscribers"}),"\n",(0,r.jsx)(n.p,{children:"A subscriber receives messages from a specific topic. The callback function is executed whenever a message is received on that topic."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"def subscription_callback(self, msg):\n    self.get_logger().info('I heard: \"%s\"' % msg.data)\n\n# Create a subscriber\nself.subscription = self.create_subscription(\n    String,\n    'topic',\n    subscription_callback,\n    10)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"services",children:"Services"}),"\n",(0,r.jsx)(n.p,{children:"Services provide a request-response communication pattern. A client sends a request to a service and waits for a response. This is a synchronous communication method."}),"\n",(0,r.jsx)(n.h3,{id:"creating-a-service-server",children:"Creating a Service Server"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from example_interfaces.srv import AddTwoInts\n\nclass MinimalService(Node):\n    def __init__(self):\n        super().__init__('minimal_service')\n        self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\n\n    def add_two_ints_callback(self, request, response):\n        response.sum = request.a + request.b\n        self.get_logger().info('Incoming request\\na: %d b: %d' % (request.a, request.b))\n        return response\n"})}),"\n",(0,r.jsx)(n.h3,{id:"creating-a-service-client",children:"Creating a Service Client"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class MinimalClientAsync(Node):\n    def __init__(self):\n        super().__init__('minimal_client_async')\n        self.cli = self.create_client(AddTwoInts, 'add_two_ints')\n\n    def send_request(self, a, b):\n        while not self.cli.wait_for_service(timeout_sec=1.0):\n            self.get_logger().info('Service not available, waiting again...')\n        \n        request = AddTwoInts.Request()\n        request.a = a\n        request.b = b\n        self.future = self.cli.call_async(request)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"communication-patterns-comparison",children:"Communication Patterns Comparison"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Pattern"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Use Case"}),(0,r.jsx)(n.th,{children:"Example"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Publisher/Subscriber"}),(0,r.jsx)(n.td,{children:"Asynchronous"}),(0,r.jsx)(n.td,{children:"Continuous data flow"}),(0,r.jsx)(n.td,{children:"Sensor data, robot state"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Service/Client"}),(0,r.jsx)(n.td,{children:"Synchronous"}),(0,r.jsx)(n.td,{children:"Request/Response"}),(0,r.jsx)(n.td,{children:"Calculations, configuration"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Action"}),(0,r.jsx)(n.td,{children:"Asynchronous with feedback"}),(0,r.jsx)(n.td,{children:"Long-running tasks"}),(0,r.jsx)(n.td,{children:"Navigation, manipulation"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use meaningful names"}),": Choose descriptive names for your nodes, topics, and services"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Follow naming conventions"}),": Use lowercase with underscores (e.g., ",(0,r.jsx)(n.code,{children:"robot_state"}),", ",(0,r.jsx)(n.code,{children:"move_arm"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Handle failures gracefully"}),": Always check if services are available before calling them"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use appropriate QoS settings"}),": Quality of Service settings affect message delivery guarantees"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Keep nodes focused"}),": Each node should have a single responsibility"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"example-simple-publisher-subscriber-system",children:"Example: Simple Publisher-Subscriber System"}),"\n",(0,r.jsx)(n.p,{children:"Here's a complete example of a publisher-subscriber system:"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Publisher"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass Talker(Node):\n    def __init__(self):\n        super().__init__('talker')\n        self.publisher = self.create_publisher(String, 'chatter', 10)\n        timer_period = 1.0  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = 'Hello from talker: %d' % self.get_clock().now().nanoseconds\n        self.publisher.publish(msg)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    talker = Talker()\n\n    try:\n        rclpy.spin(talker)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        talker.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Subscriber"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass Listener(Node):\n    def __init__(self):\n        super().__init__('listener')\n        self.subscription = self.create_subscription(\n            String,\n            'chatter',\n            self.listener_callback,\n            10)\n        self.subscription  # Prevent unused variable warning\n\n    def listener_callback(self, msg):\n        self.get_logger().info('I heard: \"%s\"' % msg.data)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    listener = Listener()\n\n    try:\n        rclpy.spin(listener)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        listener.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h2,{id:"example-serviceclient-implementation",children:"Example: Service/Client Implementation"}),"\n",(0,r.jsx)(n.p,{children:"Here's a complete example of a service/client implementation:"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Service Server"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\nclass MinimalService(Node):\n    def __init__(self):\n        super().__init__('minimal_service')\n        self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\n\n    def add_two_ints_callback(self, request, response):\n        response.sum = request.a + request.b\n        self.get_logger().info('Incoming request\\na: %d b: %d' % (request.a, request.b))\n        return response\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_service = MinimalService()\n\n    try:\n        rclpy.spin(minimal_service)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        minimal_service.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Service Client"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\nclass MinimalClient(Node):\n    def __init__(self):\n        super().__init__('minimal_client')\n        self.cli = self.create_client(AddTwoInts, 'add_two_ints')\n        while not self.cli.wait_for_service(timeout_sec=1.0):\n            self.get_logger().info('Service not available, waiting again...')\n        self.req = AddTwoInts.Request()\n\n    def send_request(self, a, b):\n        self.req.a = a\n        self.req.b = b\n        self.future = self.cli.call_async(self.req)\n        return self.future\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_client = MinimalClient()\n    future = minimal_client.send_request(2, 3)\n\n    try:\n        rclpy.spin_until_future_complete(minimal_client, future)\n        if future.result() is not None:\n            response = future.result()\n            minimal_client.get_logger().info(\n                'Result of add_two_ints: %d' % response.sum)\n        else:\n            minimal_client.get_logger().info('Service call failed')\n    except KeyboardInterrupt:\n        pass\n    finally:\n        minimal_client.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.p,{children:"This communication model allows for flexible and decoupled robot architectures, where different parts of the system can be developed and tested independently."})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>l,x:()=>o});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);